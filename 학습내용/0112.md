## 오늘 한 것

express 공부

Database 공부

bitnami wamp을 통해서 mysql을 다운받으려고 시도 → mysql이 아니라 mariaDB 설치 → 내일 재설치.(wamp pack manager를 통해 켰다 끌 수 있다)

```jsx
npm install
```

명령어를 실행시킨 곳에서 node.js의 npm package manager가 package.json라는 파일을 찾는다. 그 파일안에 dependencies 내용을 보고 senitize-html(연습 파일 안의 내용)이라고 하는 것이 이 어플리케이션에 필요하구나 하는것을 알고 그걸 인터넷에서 다운로드 받아서 node_modules 디렉토리에 저장한다.

저 명령어를 입력하면 다음과 같은 에러가 나타났다.
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'npm install' at line 1

⇒ 경로 설정 문제. package.json 있는 곳으로 이동해서 실행해서 해결

---

 node.js에서 npm을 통해 mysql 설치

```jsx
npm install mysql
npm install --save mysql // package.json에 추가하는 것 까지 같이 함.
우리의 소스코드를 다른 곳에서 다시 복제하거나 생성할 때 이 package.json안에 있는 내용을 바탕으로 해서 mysql도 쉽게 설치 가능
```

Error: ER_ACCESS_DENIED_ERROR: Access denied for user 'root'@'localhost' (using password: YES)

```jsx
SELECT * FROM user;
```

→ 현재 들어와있는 db에 있는 유저 테이블을 보는 명령

```jsx
SELECT * FROM mysql.user;
```

mysql라는 db안에 있는 유저테이블

create user mysql

유저를 생성하고, 생성된 유저에게 권한을 주고, 권한을 적용해야 한다.

지금까지는 root 유저로 모든 작업을 하려고 했지만 nodejs라는 새로운 계정을 하나 만들었다.

```jsx
CREATE USER 'nodejs'@'localhost' // localhost로 접속하는 nodejs 유저
CREATE USER 'nodejs'@'%' // 어디에 접속하건 상관없이 그 사람의 id가 nodejs면 이 사용자에 해당
CREATE USER 'nodejs'@'%' IDENTIFIED BY '비밀번호';
```

권한 주기

```jsx
GRANT ALL PRIVILEGES ON DB.* TO 'nodejs'@'%'// DB의 모든 테이블에 모든 권한을 주겠다.
```

권한 적용

```jsx
FLUSH PRIVILEGES; // 세팅한 것을 실제로 DB에 적용
```

→ 코드 내에서 유저 이름 변경

```jsx
var connection = mysql.createConnection({
  host : 'localhost',
  user : 'nodejs',
  password : 'secret',
  database : 'opentutorials'
});
```

→ 근데 이래도 문제 해결 안되었다.

```jsx
netstat -ano | findstr :3306 // 
```

cmd에 이걸 입력해서 3306 포트를 사용하는 프로세스가 2개 이상이었음. 

그냥 mysql 과 bitnami wampstack 의 mysql 프로세스가 3306 포트를 동시에 사용하고 있었더라구요.

작업관리자에서 해당 PID를 가진 녀석을 제거해 줬더니

Error: connect ECONNREFUSED 127.0.0.1:3306

문제 발생

→ mysql을 재시작 하면 해결된다고 한다. 지금 설치되어 있는건 mariaDB인데 bitnami wamp를 깔아서 그렇다. 이것 자체를 삭제한 후, community에 있는 경로로 다시 설치해보려고 했는데 unstall을 해도 아직 서비스에는 남아있는 것 같다. 내일 이어서 해결해보자.